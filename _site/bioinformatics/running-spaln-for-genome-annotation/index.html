<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
	<title>Running Spaln for Genome Annotation • Generally Biology</title>
    <meta name="description" content="Before entering the Fei Lab I had never head of SPALN, and quite frankly, no
one I knew had either. While small and unknown, SPALN is useful in genomic
annotaation in its capacity to align various CDS sequences from other species
to your current genome. This comes in and assists tremendously with annotation
later on when running MAKER. So, if well annotataed closely related organisms
are availabe, SPALN is a useful tool that will be worth running.

">
    <meta name="keywords" content="">
    
    	<!-- Twitter Cards -->
	<meta name="twitter:title" content="Running Spaln for Genome Annotation">
	<meta name="twitter:description" content="Before entering the Fei Lab I had never head of SPALN, and quite frankly, no
one I knew had either. While small and unknown, SPALN is useful in genomic
annotaation in its capacity to align various CDS sequences from other species
to your current genome. This comes in and assists tremendously with annotation
later on when running MAKER. So, if well annotataed closely related organisms
are availabe, SPALN is a useful tool that will be worth running.

">
	
	
	
	<meta name="twitter:card" content="summary">
	<meta name="twitter:image" content="/images/dnaimage.jpg">
	
	<!-- Open Graph -->
	<meta property="og:locale" content="en">
	<meta property="og:type" content="article">
	<meta property="og:title" content="Running Spaln for Genome Annotation">
	<meta property="og:description" content="Before entering the Fei Lab I had never head of SPALN, and quite frankly, no
one I knew had either. While small and unknown, SPALN is useful in genomic
annotaation in its capacity to align various CDS sequences from other species
to your current genome. This comes in and assists tremendously with annotation
later on when running MAKER. So, if well annotataed closely related organisms
are availabe, SPALN is a useful tool that will be worth running.

">
	<meta property="og:url" content="/bioinformatics/running-spaln-for-genome-annotation/">
	<meta property="og:site_name" content="Generally Biology">

    <link rel="canonical" href="/bioinformatics/running-spaln-for-genome-annotation/">

    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Generally Biology Atom Feed">
    <link href="/sitemap.xml" type="application/xml" rel="sitemap" title="Sitemap">

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="cleartype" content="on">

    <link rel="stylesheet" href="/css/main.css">
    <!-- HTML5 Shiv and Media Query Support for IE -->
    <!--[if lt IE 9]>
      <script src="/js/vendor/html5shiv.min.js"></script>
      <script src="/js/vendor/respond.min.js"></script>
    <![endif]-->

  </head>

  <body id="js-body">
    <!--[if lt IE 9]><div class="upgrade notice-warning"><strong>Your browser is quite old!</strong> Why not <a href="http://whatbrowser.org/">upgrade to a newer one</a> to better enjoy this site?</div><![endif]-->

    <header id="masthead">
  <div class="inner-wrap">
    <a href="/" class="site-title">Generally Biology</a>
    <nav role="navigation" class="menu top-menu">
        <ul class="menu-item">
	<li class="home"><a href="/">Generally Biology</a></li>
	
    
    <li><a href="/" >Home</a></li>
  
    
    <li><a href="/blog/" >Blog</a></li>
  
    
    <li><a href="/collections/" >Collections</a></li>
  
    
    <li><a href="/about/" >About</a></li>
  
</ul>
    </nav>
  </div><!-- /.inner-wrap -->
</header><!-- /.masthead -->

    <nav role="navigation" id="js-menu" class="sliding-menu-content">
  <h5>Generally Biology <span>Table of Contents</span></h5>
  <ul class="menu-item">
    <li>
      <a href="/">
        
        <div class="title">Home</div>
        <p class="excerpt">Generally Biology</p>
      </a>
    </li><li>
      <a href="/blog/">
        
        <div class="title">Blog</div>
        <p class="excerpt">My Writings on Biology, and computers, and the insane intersection between the two that we call bioinformatics/computational biology.</p>
      </a>
    </li><li>
      <a href="/collections/">
        
        <div class="title">Collections</div>
        <p class="excerpt">Writings on specific subjects</p>
      </a>
    </li><li>
      <a href="/about/">
        
        <div class="title">About</div>
        <p class="excerpt">John Pablo Mendieta</p>
      </a>
    </li>
  </ul>
</nav>
<button type="button" id="js-menu-trigger" class="sliding-menu-button lines-button x2" role="button" aria-label="Toggle Navigation">
  <span class="nav-lines"></span>
</button>

<div id="js-menu-screen" class="menu-screen"></div>


    <div id="page-wrapper">
      <div id="main" role="main">
	<article class="wrap" itemscope itemtype="http://schema.org/Article">
		
		
  <nav class="breadcrumbs">
    <span itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
      <a href="" itemprop="url">
        <span itemprop="title">Home</span>
      </a> › 
    <span itemscope itemtype="http://data-vocabulary.org/Breadcrumb">
      <a href="/Bioinformatics/" itemprop="url">
        <span itemprop="title">Bioinformatics</span>
      </a>
    </span>
  </nav><!-- /.breadcrumbs -->

		<div class="page-title">
			<h1>Running Spaln for Genome Annotation</h1>
		</div>
		<div class="inner-wrap">
			<div id="content" class="page-content" itemprop="articleBody">
				<p>Before entering the Fei Lab I had never head of SPALN, and quite frankly, no
one I knew had either. While small and unknown, SPALN is useful in genomic
annotaation in its capacity to align various CDS sequences from other species
to your current genome. This comes in and assists tremendously with annotation
later on when running MAKER. So, if well annotataed closely related organisms
are availabe, SPALN is a useful tool that will be worth running.</p>

<p>That being said, SPALN is not an easy tool to work with. It comes out of the
university of Kyoto, has a minimalist website, and rather unclear documentation
which you can read
<a href="http://www.genome.ist.i.kyoto-u.ac.jp/~aln_user/spaln/#Usr">here</a>. Below i’ll
detail I install and ran this program. If you’re still unconvinced on the
usefullness of SPALN, I reccomend reading their
<a href="https://academic.oup.com/nar/article/40/20/e161/2414522">publication</a></p>

<h4 id="download-and-install-spaln">Download and Install SPALN</h4>

<p>To install SPALN I heavily reccomend using the pre-compiled binaries from a
specific github linke.. Since there is little to no trouble shooting help, attempting to fix any issue with
compililation can be incredibly tedious. The linked github also has the
advantage of a perl script which will allow us to avoid creating tedious
indexes by hand.</p>

<p>To download:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>git clone https://github.com/ogotoh/spaln
</code></pre>
</div>

<p>This is where SPALN gets a little tricky. In order to align proteins, the
proteins, and all refernce scripts have to be in the same directory. Also,
we’re going to have to change the ending to our files for the program to
recognize them. The genome should have a .mfa ending, and the sequences to be
aligned should have a .faa ending.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>#Make A directory and move everything to this directory
mkdir spaln_work
mv ./table/* spaln_work
mv ./seqdb/* spaln_work

# link to genome and protein
ln -s /data/pabster212/genomes/Gy14_v2.0_final.fa . 
ln -s /data/pabster212/genomes/TAIR11.pep.fa .

#Change ending names. Spaln requires a specified ending name to run
mv Gy14_v2.0_final.fa Gy14.mfa
mv TAIR10_pep.fa TAIR10_pep.faa
</code></pre>
</div>
<p>From there, we need to create a few index files before we can run the final
program. The easiest way of doing this being to utalize the makeidx.pl software
in the perl folder.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>/Programs/spaln/seqdb/makeidx.pl -ipn ${genome}
</code></pre>
</div>

<p>After this, multiple .idx files should be generated. These are binary files
that will be used for alinment. To run the final step of the software just run
the following command.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>spaln -t1 -M4 -Q7 -O0 -LS -ya2 -o TAIR10.spaln.gff3 -dGy14 $TAIR_10.faa
</code></pre>
</div>

<p>So, that’s it! Hopefully your SPALN run went well. After this, I would
reccomend editing your SPALN gff3 files in order to reformat them for use with
other software. If you’re looking for a quick way to do this I reccomend my own
gff3 editing code built specifically for SPALN. You can find this code here https://github.com/Jome0169/NoMoreScripting under the “annotation” folder. Simply run the command</p>

<div class="highlighter-rouge"><pre class="highlight"><code>python3 /data/pabster212/Programs/NoMoreScripting/nomorescripting/annotation/readgff.py -g WM97v1.spaln.gff3 -f1 100 -f2 50000 -spaln -o WM97v1.spaln.clean.gff3
</code></pre>
</div>

<p>This will clean the  SPALN, replace the second column of the gff3 and only keep alignments betwenn 100 and 50000. Sometimes SPALN makes the mistake of outputting far too large of proteins.</p>

				<hr />
				<footer class="page-footer">
					

<div class="author-image">
	<img src="/images/" alt="">
</div><!-- ./author-image -->
<div class="author-content">
	<h3 class="author-name" >Written by Pablo Mendieta <span itemprop="author"></span></h3>
	<p class="author-bio"></p>
</div><!-- ./author-content -->

					<div class="inline-btn">
	<a class="btn-social twitter" href="https://twitter.com/intent/tweet?text=Running%20Spaln%20for%20Genome%20Annotation&amp;url=/bioinformatics/running-spaln-for-genome-annotation/&amp;via=" target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i>  Twitter</a>
	<a class="btn-social facebook" href="https://www.facebook.com/sharer/sharer.php?u=/bioinformatics/running-spaln-for-genome-annotation/" target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i>  Facebook</a>

	</div><!-- /.share-this -->

					<div class="page-meta">
	<p>Updated <time datetime="2018-02-19T10:35:00Z" itemprop="datePublished">February 19, 2018</time></p>
</div><!-- /.page-meta -->

				</footer><!-- /.footer -->
				<aside>
					<hr />
<div id="disqus_thread"></div>
<script type="text/javascript">
	/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
	var disqus_shortname = '';

	/* * * DON'T EDIT BELOW THIS LINE * * */
	(function() {
		var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
		dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

				</aside>
			</div><!-- /.content -->
		</div><!-- /.inner-wrap -->
		
	</article><!-- ./wrap -->
</div><!-- /#main -->

      <footer role="contentinfo" id="site-footer">
	<nav role="navigation" class="menu bottom-menu">
		<ul class="menu-item">
		
      
			<li><a href="" >Follow:</a></li>
		
      
			<li><a href="https://twitter.com/pabster212?lang=en" target="_blank">Twitter</a></li>
		
      
			<li><a href="https://github.com/Jome0169" target="_blank">Github</a></li>
		
      
			<li><a href="https://www.linkedin.com/in/john-mendieta-016305119/" target="_blank">Linkedin</a></li>
		
		</ul>
	</nav><!-- /.bottom-menu -->
	<p class="copyright">&#169; 2018 <a href="">Generally Biology</a> powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> + <a href="http://mmistakes.github.io/skinny-bones-jekyll/" rel="nofollow">Skinny Bones</a>.</p>
</footer>

    </div>

    <script src="/js/vendor/jquery-1.9.1.min.js"></script>
    <script src="/js/main.js"></script>

  </body>

</html>
